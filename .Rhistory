#     tq_get(
#         "VIXCLS"
#         , get = "economic.data"
#         , from = "2014-01-03"
#         , to = "2018-12-29"
#     )
df_vol_index <-
vol_index(chr_underlying) %>%
read_csv()
df_vol_index$Date <- mdy(df_vol_index$Date)
#df_vol_index$Close <- as.numeric(df_vol_index$Close)
df_vol_index <-
df_vol_index %>% filter(Close == "n/a")
#####################
## all trade dates ##
#####################
df_td_all <-
tibble(
trade_date = bizseq(from = "2014-01-03", to = "2018-12-29")
)
#dt_all <- bizseq(ymd(20140103), ymd(20181229))
#df_td_all <- tibble(trade_date = dt_all)
###################################################
## grabbing price data from yahoo with tidyquant ##
###################################################
df_underlying_px <-
tq_get(chr_underlying, from = "2014-01-03", to = "2018-12-29")
########################################################
## grabbing volatility index from FRED with tidyquant ##
########################################################
# df_vol_index <-
#     tq_get(
#         "VIXCLS"
#         , get = "economic.data"
#         , from = "2014-01-03"
#         , to = "2018-12-29"
#     )
df_vol_index <-
vol_index(chr_underlying) %>%
read_csv()
df_vol_index$Date <- mdy(df_vol_index$Date)
#df_vol_index$Close <- as.numeric(df_vol_index$Close)
df_vol_index %>% filter(Close == "n/a")
#####################
## all trade dates ##
#####################
df_td_all <-
tibble(
trade_date = bizseq(from = "2014-01-03", to = "2018-12-29")
)
#dt_all <- bizseq(ymd(20140103), ymd(20181229))
#df_td_all <- tibble(trade_date = dt_all)
###################################################
## grabbing price data from yahoo with tidyquant ##
###################################################
df_underlying_px <-
tq_get(chr_underlying, from = "2014-01-03", to = "2018-12-29")
########################################################
## grabbing volatility index from FRED with tidyquant ##
########################################################
# df_vol_index <-
#     tq_get(
#         "VIXCLS"
#         , get = "economic.data"
#         , from = "2014-01-03"
#         , to = "2018-12-29"
#     )
df_vol_index <-
vol_index(chr_underlying) %>%
read_csv()
df_vol_index$Date <- mdy(df_vol_index$Date)
df_vol_index$Close <- as.numeric(df_vol_index$Close)
df_vol_index %>% filter(is.na(Close))
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
# clearing out
rm(list = ls())
cat("\014")
# loading packages
library(tidyverse)
library(backtestr)
library(bizdays)
# initializing bizdays libraries
load_rmetrics_calendars(2000:2020)
bizdays.options$set(default.calendar="Rmetrics/NYSE")
chr_path <- "/Users/Pritam/Desktop/L3_20190301/L3_options_20190301.csv"
df_option_all <-
backtestr::csv_option_all(chr_path)
dt_analysis <- as.Date("2010-03-01")
source('~/files/ods/weekly_option/testing/weekly_comparison_against_tastyworks.R', echo=TRUE)
chr_underlying
source('~/files/ods/weekly_option/testing/weekly_comparison_against_tastyworks.R', echo=TRUE)
source('~/files/ods/weekly_option/testing/weekly_comparison_against_tastyworks.R', echo=TRUE)
df_universe <-
df_option_all %>%
filter(underlying_symbol %in% chr_underlying) %>%
filter(expiration == dt_expiration) %>%
distinct(expiration, dt) %>%
mutate(
analysis_date = dt_analysis
)
df_option_all %>%
filter(underlying_symbol %in% chr_underlying) %>%
filter(expiration == dt_expiration) %>%
distinct(underlying_symbol, expiration) %>%
mutate(
analysis_date = dt_analysis
)
# clearing out
# rm(list = ls())
# cat("\014")
# loading packages
library(tidyverse)
library(backtestr)
library(bizdays)
# initializing bizdays libraries
load_rmetrics_calendars(2000:2020)
bizdays.options$set(default.calendar="Rmetrics/NYSE")
chr_path <- "/Users/Pritam/Desktop/L3_20190301/L3_options_20190301.csv"
# df_option_all <-
#     backtestr::csv_option_all(chr_path)
chr_underlying_all <-
c("SPY", "GLD", "IWM", "QQQ", "DIA", "FXI", "EEM", "SLV", "GDX"
, "USO", "EWZ", "TLT", "XLE")
dt_expiration <- as.Date("2019-03-08")
dt_analysis <- as.Date("2019-03-01")
dbl_strangle_delta <- 0.10
df_universe <-
df_option_all %>%
filter(underlying_symbol %in% chr_underlying_all) %>%
filter(expiration == dt_expiration) %>%
distinct(underlying_symbol, expiration) %>%
mutate(
analysis_date = dt_analysis
)
df_universe
source('~/files/ods/weekly_option/testing/weekly_comparison_against_tastyworks.R', echo=TRUE)
source('~/files/ods/weekly_option/testing/weekly_comparison_against_tastyworks.R', echo=TRUE)
df_universe
df_opt_to_trade
df_strangle
write_csv(df_universe, "tastyworks_comparison_universe.csv")
write_csv(df_opt_to_trade, "tastyworks_comparison_otm_opt.csv")
write_csv(df_strangle, "tastywrks_comparison_strangle.csv")
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
unlink('testing/weekly_option_data_integrity_test_cache', recursive = TRUE)
library(tidyverse)
df_chain_desc <-
read_csv("data_output/xle_weekly_2014_2018_chain_desc.csv")
source('~/files/ods/weekly_option/fm5990_project/data_prep_for_students.R', echo=TRUE)
##
df_chain_desc
View(df_chain_desc)
df_chain_hist
df_chain_desc %>%
left_join(
df_chain_hist
, by = c("execution" = "trade_date")
)
df_chain_hist
View(df_chain_hist)
##
df_chain_desc %>%
left_join(
df_chain_hist
, by = c("expiration", "execution" = "trade_date")
)
##########################
## df_chain_description ##
##########################
df_chain_desc %>%
left_join(
df_chain_hist
, by = c("underlying", "expiration", "execution" = "trade_date")
)
df_chain <-
df_chain_desc %>%
left_join(
df_chain_hist
, by = c("underlying", "expiration", "execution" = "trade_date")
) %>%
select(
underlying, expiration, last_trade_date, execution, d2x, ret
, realized_vol, implied_vol, mid_swap_rate
)
##########################
## df_chain_description ##
##########################
df_chain <-
df_chain_desc %>%
left_join(
df_chain_hist
, by = c("underlying", "expiration", "execution" = "trade_date")
) %>%
select(
underlying, expiration, last_trade_date, last_trade_date.x
, execution, d2x, ret, realized_vol, implied_vol, mid_swap_rate
)
##########################
## df_chain_description ##
##########################
df_chain <-
df_chain_desc %>%
left_join(
df_chain_hist
, by = c("underlying", "expiration", "execution" = "trade_date")
) %>%
select(
underlying, expiration, last_trade_date = last_trade_date.x
, execution, d2x, ret, realized_vol, implied_vol, mid_swap_rate
)
##########################
## df_chain_description ##
##########################
df_chain <-
df_chain_desc %>%
left_join(
df_chain_hist
, by = c("underlying", "expiration", "execution" = "trade_date")
) %>%
select(
underlying, expiration, last_trade_date = last_trade_date.x
, execution, d2x, ret, realized_vol, implied_vol = mid_swap_rate
)
View(df_chain)
############
## df_upx ##
############
df_underlying_px <-
tq_get(chr_underlying, from = "2014-01-03", to = "2018-12-29")
libarary(tidyquant)
############
## df_upx ##
############
df_underlying_px <-
tq_get(chr_underlying, from = "2014-01-03", to = "2018-12-29")
rm(list = ls())
cat("\014")
library(tidyverse)
library(tidyquant)
########################
## setting underlying ##
########################
chr_underlying <- "XLE"
#####################
## reading in data ##
#####################
# chain description
chr_path <-
paste0(
"data_output/", str_to_lower(chr_underlying)
, "_weekly_2014_2018_chain_desc.csv"
)
df_chain_desc <- read_csv(chr_path)
# chain history
chr_path <-
paste0(
"data_output/", str_to_lower(chr_underlying)
, "_weekly_2014_2018_chain_hist.csv"
)
df_chain_hist <-read_csv(chr_path)
# option history
chr_path <-
paste0(
"data_output/", str_to_lower(chr_underlying)
, "_weekly_2014_2018_opt_hist.csv"
)
df_opt_hist <- read_csv(chr_path)
# pnl master
chr_path <-
paste0(
"data_output/", str_to_lower(chr_underlying)
, "_weekly_2014_2018_pnl_master.csv"
)
df_pnl <- read_csv(chr_path)
# trade master
chr_path <-
paste0(
"data_output/", str_to_lower(chr_underlying)
, "_weekly_2014_2018_trade_master.csv"
)
df_trade <- read_csv(chr_path)
##############
## df_chain ##
##############
df_chain <-
df_chain_desc %>%
left_join(
df_chain_hist
, by = c("underlying", "expiration", "execution" = "trade_date")
) %>%
select(
underlying, expiration, last_trade_date = last_trade_date.x
, execution, d2x, ret, realized_vol, implied_vol = mid_swap_rate
)
############
## df_upx ##
############
df_underlying_px <-
tq_get(chr_underlying, from = "2014-01-03", to = "2018-12-29")
View(df_trade)
df_trade
##############
## df_trade ##
##############
df_trade %>%
filter(variation == 0.3) %>%
select(
underlying, expiration, execution, last_trade_date, type, strike,
, data_date, upx = underlying_price, bid, ask, delta
)
df_trade %>%
filter(variation == 0.3)
df_trade %>%
filter(variation == 0.3) %>%
select(
underlying, expiration, execution, last_trade_date, type, strike,
, data_date, upx = underlying_price, bid, ask, delta
)
##############
## df_trade ##
##############
df_trade %>%
filter(variation == 0.3) %>%
select(
underlying, expiration, execution, last_trade_date, type, strike
, data_date, upx = underlying_price, bid, ask, delta
)
View(df_trade)
##############
## df_trade ##
##############
df_trade <-
df_trade_all %>%
filter(variation == 0.3) %>%
select(
underlying, expiration, execution, last_trade_date, type, strike
, data_date, upx = underlying_price, bid, ask, delta
)
# trade master
chr_path <-
paste0(
"data_output/", str_to_lower(chr_underlying)
, "_weekly_2014_2018_trade_master.csv"
)
df_trade_all <- read_csv(chr_path)
##############
## df_trade ##
##############
df_trade <-
df_trade_all %>%
filter(variation == 0.3) %>%
select(
underlying, expiration, execution, last_trade_date, type, strike
, data_date, upx = underlying_price, bid, ask, delta
)
df_trade
############
## df_pnl ##
############
df_pnl_master %>%
filter(variation == 0.3)
# pnl master
chr_path <-
paste0(
"data_output/", str_to_lower(chr_underlying)
, "_weekly_2014_2018_pnl_master.csv"
)
df_pnl_master <- read_csv(chr_path)
df_pnl_master %>%
filter(variation == 0.3)
############
## df_pnl ##
############
df_pnl_master %>%
filter(variation == 0.3) %>%
select(
underlying = underlying_symbol, upx = underlying_price, expiration
, type, strike, data_date, bid, ask, delta, dly_opt_pnl, dly_dh_pnl
, dly_tot_pnl
)
chr_file_name <-
paste0(chr_underlying, "_chain.csv")
write_csv(df_chain, chr_file_name)
chr_file_name <-
paste0(chr_underlying, "_upx.csv")
write_csv(df_upx, chr_file_name)
chr_file_name <-
paste0(chr_underlying, "_trade.csv")
write_csv(df_trade, chr_file_name)
chr_file_name <-
paste0(chr_underlying, "_pnl.csv")
write_csv(df_pnl, chr_file_name)
############
## df_upx ##
############
df_upx <-
tq_get(chr_underlying, from = "2014-01-03", to = "2018-12-29")
chr_file_name <-
paste0(chr_underlying, "_chain.csv")
write_csv(df_chain, chr_file_name)
chr_file_name <-
paste0(chr_underlying, "_upx.csv")
write_csv(df_upx, chr_file_name)
chr_file_name <-
paste0(chr_underlying, "_trade.csv")
write_csv(df_trade, chr_file_name)
chr_file_name <-
paste0(chr_underlying, "_pnl.csv")
write_csv(df_pnl, chr_file_name)
df_pnl <-
df_pnl_master %>%
filter(variation == 0.3) %>%
select(
underlying = underlying_symbol, upx = underlying_price, expiration
, type, strike, data_date, bid, ask, delta, dly_opt_pnl, dly_dh_pnl
, dly_tot_pnl
)
source('~/files/ods/weekly_option/fm5990_project/data_prep_for_students.R', echo=TRUE)
source('~/files/ods/weekly_option/fm5990_project/data_prep_for_students.R', echo=TRUE)
source('~/files/ods/weekly_option/fm5990_project/data_prep_for_students.R', echo=TRUE)
source('~/files/ods/weekly_option/fm5990_project/data_prep_for_students.R', echo=TRUE)
source('~/files/ods/weekly_option/fm5990_project/data_prep_for_students.R', echo=TRUE)
source('~/files/ods/weekly_option/fm5990_project/data_prep_for_students.R', echo=TRUE)
source('~/files/ods/weekly_option/fm5990_project/data_prep_for_students.R', echo=TRUE)
source('~/files/ods/weekly_option/fm5990_project/data_prep_for_students.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
View(df_chain)
View(df_chain)
# clearing shit out
rm(list=ls())
cat("\014")
# loading packages
library(tidyverse)
library(lubridate)
library(bizdays)
library(tictoc)
library(backtestr)
library(tidyquant)
# sourcing functions
source("function/missing_data.R")
source("function/chain_weekly.R")
source("function/chain_monthly.R")
# initializing bizdays libraries
load_rmetrics_calendars(2000:2020)
bizdays.options$set(default.calendar="Rmetrics/NYSE")
# setting underlying
underlying <- "XLE" # don't call this variable chr_underlying
# creating df_chain
#df_chain <- chain_weekly(underlying)
df_chain <- chain_monthly(underlying)
View(df_chain)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/01_wrangler_market.R', echo=TRUE)
source('~/files/ods/weekly_option/script/02_wrangler_trade_pnl.R', echo=TRUE)
