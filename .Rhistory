unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
df_sharpe <-
df_pnl_daily %>%
group_by(tenor, underlying_symbol, variation) %>%
summarize(
avg_naked = mean(naked)
, avg_dh = mean(dh)
, sd_naked = sd(naked)
, sd_dh = sd(dh)
, sharpe_naked = (mean(naked) / sd(naked)) * sqrt(252)
, sharpe_dh = (mean(dh) / sd(dh)) * sqrt(252)
)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
library(tidyverse)
# Chunk 3
chr_csv_file_names <-
list.files(
"data_output/monthly"
, full.names = TRUE
, pattern = ".*_pnl_master.csv*"
)
lst_monthly <- list()
for (ix in 1:length(chr_csv_file_names)){
lst_monthly[[length(lst_monthly) + 1]] <-
read_csv(chr_csv_file_names[ix], col_types = cols())
}
df_monthly <- bind_rows(lst_monthly)
df_monthly <-
df_monthly %>% mutate(tenor = "monthly")
# Chunk 4
chr_csv_file_names <-
list.files(
"data_output/weekly"
, full.names = TRUE
, pattern = ".*_pnl_master.csv*"
)
lst_weekly <- list()
for (ix in 1:length(chr_csv_file_names)){
lst_weekly[[length(lst_weekly) + 1]] <-
read_csv(chr_csv_file_names[ix], col_types = cols())
}
df_weekly <- bind_rows(lst_weekly)
df_weekly <-
df_weekly %>% mutate(tenor = "weekly")
# Chunk 5
df_pnl <- bind_rows(df_monthly, df_weekly)
# Chunk 6
df_pnl_daily <-
df_pnl %>%
group_by(tenor, underlying_symbol, variation, data_date) %>%
summarize(
naked = sum(dly_opt_pnl)
, dh = sum(dly_tot_pnl)
) %>%
mutate(
ttd_naked = cumsum(naked)
, ttd_dh = cumsum(dh)
)
df_sharpe <-
df_pnl_daily %>%
group_by(tenor, underlying_symbol, variation) %>%
summarize(
avg_naked = mean(naked)
, avg_dh = mean(dh)
, sd_naked = sd(naked)
, sd_dh = sd(dh)
, sharpe_naked = (mean(naked) / sd(naked)) * sqrt(252)
, sharpe_dh = (mean(dh) / sd(dh)) * sqrt(252)
)
df_sharpe
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter(avg_naked_weekly > avg_naked_monthly)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter(avg_naked_weekly > avg_naked_monthly) %>%
fitler(sd_naked_weekly < sd_naked_monthly)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter(avg_naked_weekly > avg_naked_monthly) %>%
filter(sd_naked_weekly < sd_naked_monthly)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
fitler(avg_naked_weekly > 0 ) %>%
filter(avg_naked_monthly)
# filter(avg_naked_weekly > avg_naked_monthly) %>%
# filter(sd_naked_weekly < sd_naked_monthly)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter(avg_naked_weekly > 0 ) %>%
filter(avg_naked_monthly)
# filter(avg_naked_weekly > avg_naked_monthly) %>%
# filter(sd_naked_weekly < sd_naked_monthly)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter(avg_naked_weekly > 0 ) %>%
filter(avg_naked_monthly > 0)
# filter(avg_naked_weekly > avg_naked_monthly) %>%
# filter(sd_naked_weekly < sd_naked_monthly)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
#filter(avg_naked_weekly > 0 ) %>%
#filter(avg_naked_monthly > 0)
# filter(avg_naked_weekly > avg_naked_monthly) %>%
filter(sd_naked_weekly < sd_naked_monthly)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter(avg_naked_weekly > 0 ) %>%
filter(avg_naked_monthly > 0)
filter(avg_naked_weekly > avg_naked_monthly) %>%
filter(sd_naked_weekly < sd_naked_monthly)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter(avg_naked_weekly > 0 ) %>%
filter(avg_naked_monthly > 0) %>%
filter(avg_naked_weekly > avg_naked_monthly) %>%
filter(sd_naked_weekly < sd_naked_monthly)
unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter(avg_dh_weekly > 0) %>%
filter(avg_dh_monthly > 0) %>%
filter(sharpe_dh_weekly > sharpe_dh_monthly)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter(avg_dh_weekly > 0) %>%
filter(avg_dh_monthly > 0) #%>%
#filter(sharpe_dh_weekly > sharpe_dh_monthly)
## 16 of 19 have higher Sharpes
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter((avg_dh_weekly < 0) | (avg_dh_monthly < 0)) #%>%
#filter(sd_dh_weekly < sd_dh_monthly)
## 16 of 19 have higher Sharpes
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter((avg_dh_weekly < 0) | (avg_dh_monthly < 0)) %>%
filter(sd_dh_weekly < sd_dh_monthly)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter((avg_dh_weekly < 0) | (avg_dh_monthly < 0))
## 16 of 19 have higher Sharpes
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter((avg_dh_weekly < 0) | (avg_dh_monthly < 0)) %>%
filter(sd_dh_weekly < sd_dh_monthly)
## 16 of 19 have higher Sharpes
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter((avg_dh_weekly < 0) | (avg_dh_monthly < 0)) %>%
filter(avg_dh_weekly < avg_dh_monthly)
## 16 of 19 have higher Sharpes
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter((avg_dh_weekly < 0) | (avg_dh_monthly < 0)) %>%
filter(sd_dh_weekly < sd_dh_monthly)
## 16 of 19 have higher Sharpes
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter((avg_dh_weekly < 0) | (avg_dh_monthly < 0)) %>%
filter(avg_dh_weekly > avg_dh_monthly)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter(avg_naked_weekly > 0) %>%
filter(avg_naked_monthly > 0)
df_sharpe %>% filter(tenor == "monthly") %>%
left_join(
df_sharpe %>% filter(tenor=="weekly")
, by = c("underlying_symbol", "variation")
, suffix = c("_monthly", "_weekly")
) %>%
filter(avg_naked_weekly > 0) %>%
filter(avg_naked_monthly > 0) %>%
filter(sharpe_naked_weekly > sharpe_naked_monthly)
unlink('analysis/01_weekly_vs_monthly_cache', recursive = TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/05_wrangler_risk_management_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/05_wrangler_risk_management_pnl.R', echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
df_pnl <- read_csv("data_output/weekly/spy_weekly")
df_pnl <-
read_csv("../data_output/weekly/spy_weekly_2014_2018_managed_pnl.csv")
df_pnl <-
read_csv("data_output/weekly/spy_weekly_2014_2018_managed_pnl.csv")
df_pnl
df_pnl
df_pnl
df_pnl %>% distinct(strategy)
df_pnl %>% distinct(variation)
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 0) %>%
group_by(loss_trigger, data_date) %>%
summarize(
dh_pnl = sum(scaled_managed_pnl)
)
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 0) %>%
group_by(loss_trigger, data_date) %>%
summarize(
dh_pnl = sum(scaled_managed_pnl)
) %>%
group_by(loss_trigger) %>%
summarize(
avg_pnl = mean(dh_pnl)
, sd_pnl = sd(dh_pnl)
, sharpe = (mean(dh_pnl) / sd(dh_pnl)) * sqrt(252)
)
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 0) %>%
group_by(loss_trigger, data_date) %>%
summarize(
dh_pnl = sum(scaled_managed_pnl)
) %>%
group_by(loss_trigger) %>%
summarize(
avg_pnl = mean(dh_pnl)
, sd_pnl = sd(dh_pnl)
, sharpe = (mean(dh_pnl) / sd(dh_pnl)) * sqrt(252)
) %>%
ggplot() +
geom_point(x=loss_trigger, y=sharpe)
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 0) %>%
group_by(loss_trigger, data_date) %>%
summarize(
dh_pnl = sum(scaled_managed_pnl)
) %>%
group_by(loss_trigger) %>%
summarize(
avg_pnl = mean(dh_pnl)
, sd_pnl = sd(dh_pnl)
, sharpe = (mean(dh_pnl) / sd(dh_pnl)) * sqrt(252)
) %>%
ggplot() +
geom_point(aes(x=loss_trigger, y=sharpe)0
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 0) %>%
group_by(loss_trigger, data_date) %>%
summarize(
dh_pnl = sum(scaled_managed_pnl)
) %>%
group_by(loss_trigger) %>%
summarize(
avg_pnl = mean(dh_pnl)
, sd_pnl = sd(dh_pnl)
, sharpe = (mean(dh_pnl) / sd(dh_pnl)) * sqrt(252)
) %>%
ggplot() +
geom_point(aes(x=loss_trigger, y=sharpe))
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 1) %>%
group_by(loss_trigger, data_date) %>%
summarize(
dh_pnl = sum(scaled_managed_pnl)
) %>%
group_by(loss_trigger) %>%
summarize(
avg_pnl = mean(dh_pnl)
, sd_pnl = sd(dh_pnl)
, sharpe = (mean(dh_pnl) / sd(dh_pnl)) * sqrt(252)
) %>%
ggplot() +
geom_point(aes(x=loss_trigger, y=sharpe))
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 1)
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 1) %>%
group_by(loss_trigger, data_date) %>%
summarize(
dh_pnl = sum(scaled_managed_pnl)
)
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 1) %>%
group_by(loss_trigger, data_date) %>%
summarize(
dh_pnl = sum(scaled_managed_pnl)
) %>%
group_by(loss_trigger) %>%
summarize(
avg_pnl = mean(dh_pnl)
, sd_pnl = sd(dh_pnl)
, sharpe = (mean(dh_pnl) / sd(dh_pnl)) * sqrt(252)
)
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 1) %>%
group_by(loss_trigger, data_date) %>%
summarize(
dh_pnl = sum(scaled_managed_pnl)
) %>%
group_by(loss_trigger) %>%
summarize(
avg_pnl = mean(dh_pnl)
, sd_pnl = sd(dh_pnl)
, sharpe = (mean(dh_pnl) / sd(dh_pnl)) * sqrt(252)
) %>%
ggplot() +
geom_point(aes(x=loss_trigger, y=sharpe))
source('~/files/ods/weekly_option/script/05_wrangler_risk_management_pnl.R', echo=TRUE)
df_pnl <-
read_csv("data_output/weekly/spy_monthly_2014_2018_managed_pnl.csv")
df_pnl <-
read_csv("data_output/monthly/spy_monthly_2014_2018_managed_pnl.csv")
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 0) %>%
group_by(loss_trigger, data_date) %>%
summarize(
dh_pnl = sum(scaled_managed_pnl)
) %>%
group_by(loss_trigger) %>%
summarize(
avg_pnl = mean(dh_pnl)
, sd_pnl = sd(dh_pnl)
, sharpe = (mean(dh_pnl) / sd(dh_pnl)) * sqrt(252)
) %>%
ggplot() +
geom_point(aes(x=loss_trigger, y=sharpe))
df_pnl %>%
filter(strategy == "strangle") %>%
filter(variation == 0.1) %>%
filter(dh_threshold == 1) %>%
group_by(loss_trigger, data_date) %>%
summarize(
dh_pnl = sum(scaled_managed_pnl)
) %>%
group_by(loss_trigger) %>%
summarize(
avg_pnl = mean(dh_pnl)
, sd_pnl = sd(dh_pnl)
, sharpe = (mean(dh_pnl) / sd(dh_pnl)) * sqrt(252)
) %>%
ggplot() +
geom_point(aes(x=loss_trigger, y=sharpe))
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/03_wrangler_scale_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/04_wrangler_chain_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/05_wrangler_risk_management_pnl.R', echo=TRUE)
source('~/files/ods/weekly_option/script/05_wrangler_risk_management_pnl.R', echo=TRUE)
