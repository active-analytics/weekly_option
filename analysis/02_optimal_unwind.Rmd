---
title: "Optimal Unwind: Weekly vs Monthly"
author: "Pritam Dalal"
date: "3/9/2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r}
library(tidyverse)
```



```{r}
df_pnl <- 
    read_csv("data_output/monthly/spy_monthly_2014_2018_managed_pnl.csv")
```



```{r}
df_pnl %>% 
    filter(strategy == "strangle") %>% 
    filter(variation == 0.1) %>% 
    filter(dh_threshold == 0) %>% 
    group_by(loss_trigger, data_date) %>% 
    summarize(
        dh_pnl = sum(scaled_managed_pnl)
    ) %>% 
    group_by(loss_trigger) %>% 
    summarize(
        avg_pnl = mean(dh_pnl)
        , sd_pnl = sd(dh_pnl)
        , sharpe = (mean(dh_pnl) / sd(dh_pnl)) * sqrt(252)
    ) %>% 
    ggplot() + 
        geom_point(aes(x=loss_trigger, y=sharpe))
```







```{r}
df_pnl %>% 
    filter(strategy == "strangle") %>% 
    filter(variation == 0.1) %>% 
    filter(dh_threshold == 1) %>% 
    group_by(loss_trigger, data_date) %>% 
    summarize(
        dh_pnl = sum(scaled_managed_pnl)
    ) %>% 
    group_by(loss_trigger) %>% 
    summarize(
        avg_pnl = mean(dh_pnl)
        , sd_pnl = sd(dh_pnl)
        , sharpe = (mean(dh_pnl) / sd(dh_pnl)) * sqrt(252)
    ) %>% 
    ggplot() + 
        geom_point(aes(x=loss_trigger, y=sharpe))
```




